{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./service/app.layout.service\";\nimport * as i2 from \"../service/auth/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../../app/layout/app.menu.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"primeng/avatar\";\nimport * as i7 from \"primeng/button\";\nimport * as i8 from \"./app.menuitem.component\";\nfunction AppMenuComponent_ng_container_14_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"li\", 9);\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    const item_r2 = ctx_r6.$implicit;\n    const i_r3 = ctx_r6.index;\n    i0.ɵɵproperty(\"item\", item_r2)(\"index\", i_r3)(\"root\", true);\n  }\n}\nfunction AppMenuComponent_ng_container_14_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"li\", 10);\n  }\n}\nfunction AppMenuComponent_ng_container_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AppMenuComponent_ng_container_14_li_1_Template, 1, 3, \"li\", 7);\n    i0.ɵɵtemplate(2, AppMenuComponent_ng_container_14_li_2_Template, 1, 0, \"li\", 8);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !item_r2.separator);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r2.separator);\n  }\n}\nfunction AppMenuComponent_li_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"a\", 11);\n    i0.ɵɵelement(2, \"img\", 12);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"assets/layout/images/\", ctx_r1.layoutService.config.colorScheme === \"light\" ? \"banner-primeblocks\" : \"banner-primeblocks-dark\", \".png\", i0.ɵɵsanitizeUrl);\n  }\n}\nconst _c0 = function () {\n  return {\n    \"background-color\": \"#2196F3\",\n    color: \"#ffffff\"\n  };\n};\nexport class AppMenuComponent {\n  constructor(layoutService, accountService, router, route, authService, menuservice) {\n    this.layoutService = layoutService;\n    this.accountService = accountService;\n    this.router = router;\n    this.route = route;\n    this.authService = authService;\n    this.menuservice = menuservice;\n    this.model = [];\n    this.usersList = [];\n    this.userDetails = null;\n  }\n  ngOnInit() {\n    this.loadUserDetails();\n    if (this.userDetails) {\n      this.model = this.getMenuItems(); // Suponiendo que getMenuItems es un método que devuelve los items del menú\n      this.loadUsersList(); // Suponiendo que este método depende de userDetails\n    } else {\n      this.router.navigate(['/login']); // Redirige al login si no hay detalles de usuario\n    }\n  }\n\n  getMenuItems() {\n    // Retorna los items del menú basados en el rol o permisos del usuario\n    return [{\n      label: 'Usuario',\n      icon: 'pi pi-fw pi-pencil',\n      routerLink: ['/medico/receta-create']\n    }, {\n      label: 'Mostrar Recetas',\n      icon: 'pi pi-fw pi-list',\n      routerLink: ['/medico/receta-listado']\n    }];\n  }\n  loadUserDetails() {\n    const userDetailsJson = localStorage.getItem('userDetails');\n    if (userDetailsJson) {\n      this.userDetails = JSON.parse(userDetailsJson);\n    } else {\n      console.log('No userDetails found in localStorage');\n    }\n  }\n  loadUsersList() {\n    const idUsuario = this.getCurrentidUsuario();\n    this.menuservice.getUsuariosList(idUsuario).subscribe(users => {\n      this.usersList = users;\n    }, error => {\n      console.error('Error loading users list', error);\n      // Manejar el error aquí si es necesario\n    });\n  }\n\n  getCurrentidUsuario() {\n    const userIdString = localStorage.getItem('idUsuario');\n    if (userIdString === null) {\n      console.error('No user ID found in localStorage');\n      this.router.navigate(['/login']);\n      return 0;\n    }\n    return parseInt(userIdString, 10);\n  }\n  cerrarSession() {\n    const idUsuario = this.getCurrentidUsuario();\n    this.authService.logout(idUsuario).subscribe(response => {\n      console.log('Logout successful, navigating to login');\n      this.router.navigateByUrl('/login').then(success => {\n        console.log('Navigation to login successful:', success);\n      }).catch(error => {\n        console.error('Navigation to login failed:', error);\n      });\n    }, error => {\n      console.error('Error during logout', error);\n    });\n  }\n}\nAppMenuComponent.ɵfac = function AppMenuComponent_Factory(t) {\n  return new (t || AppMenuComponent)(i0.ɵɵdirectiveInject(i1.LayoutService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i4.MenuService));\n};\nAppMenuComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppMenuComponent,\n  selectors: [[\"app-menu\"]],\n  decls: 16,\n  vars: 6,\n  consts: [[1, \"layout-menu\"], [1, \"col-12\"], [1, \"flex\", \"justify-content-center\", \"align-items-center\"], [\"label\", \"V\", \"styleClass\", \"mr-2\", \"size\", \"xlarge\", \"shape\", \"circle\"], [\"label\", \"Cerrar Sesi\\u00F3n\", \"icon\", \"pi pi-sign-out\", \"iconPos\", \"left\", \"styleClass\", \"p-button-secondary\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"app-menuitem\", \"\", 3, \"item\", \"index\", \"root\", 4, \"ngIf\"], [\"class\", \"menu-separator\", 4, \"ngIf\"], [\"app-menuitem\", \"\", 3, \"item\", \"index\", \"root\"], [1, \"menu-separator\"], [\"href\", \"https://www.primefaces.org/primeblocks-ng/#/\"], [\"alt\", \"Prime Blocks\", 1, \"w-full\", \"mt-3\", 3, \"src\"]],\n  template: function AppMenuComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ul\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h5\");\n      i0.ɵɵtext(4, \"Usuario:\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\", 2)(6, \"b\");\n      i0.ɵɵtext(7);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(8, \"br\");\n      i0.ɵɵelementStart(9, \"div\", 2);\n      i0.ɵɵelement(10, \"p-avatar\", 3);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"div\", 1)(12, \"div\", 2)(13, \"p-button\", 4);\n      i0.ɵɵlistener(\"click\", function AppMenuComponent_Template_p_button_click_13_listener() {\n        return ctx.cerrarSession();\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(14, AppMenuComponent_ng_container_14_Template, 3, 2, \"ng-container\", 5);\n      i0.ɵɵtemplate(15, AppMenuComponent_li_15_Template, 3, 1, \"li\", 6);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate((ctx.userDetails == null ? null : ctx.userDetails.personaByPersonaIdPersona2 == null ? null : ctx.userDetails.personaByPersonaIdPersona2.nombres) + \"\" + (ctx.userDetails == null ? null : ctx.userDetails.personaByPersonaIdPersona2 == null ? null : ctx.userDetails.personaByPersonaIdPersona2.apellido) || \"No User Info\");\n      i0.ɵɵadvance(3);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(5, _c0));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.model);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", false);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i6.Avatar, i7.Button, i8.AppMenuitemComponent],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["i0","AppMenuComponent","constructor","layoutService","accountService","router","route","authService","menuservice","ngOnInit","loadUserDetails","userDetails","model","getMenuItems","loadUsersList","navigate","label","icon","routerLink","userDetailsJson","localStorage","getItem","JSON","parse","console","log","idUsuario","getCurrentidUsuario","getUsuariosList","subscribe","users","usersList","error","userIdString","parseInt","cerrarSession","logout","response","navigateByUrl","then","success","catch","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\desta\\Downloads\\FrontEnd\\src\\app\\layout\\app.menu.component.html","C:\\Users\\desta\\Downloads\\FrontEnd\\src\\app\\layout\\app.menu.component.ts"],"sourcesContent":["<ul class=\"layout-menu\">\n    <div class=\"col-12\">\n        <div class=\"flex justify-content-center align-items-center\">\n            <h5>Usuario:</h5>\n\n        </div>\n        <div class=\"flex justify-content-center align-items-center\">\n            <b>{{userDetails?.personaByPersonaIdPersona2?.nombres+\"\"+ userDetails?.personaByPersonaIdPersona2?.apellido|| 'No User Info'}}</b>\n        </div>\n\n        <br>\n        <div class=\"flex justify-content-center align-items-center\">\n            <p-avatar label=\"V\" styleClass=\"mr-2\" size=\"xlarge\" [style]=\"{ 'background-color': '#2196F3', color: '#ffffff' }\" shape=\"circle\"></p-avatar>\n        </div>\n    </div>\n    <div class=\"col-12\">\n        <div class=\"flex justify-content-center align-items-center\">\n            <p-button label=\"Cerrar Sesión\" icon=\"pi pi-sign-out\" iconPos=\"left\" styleClass=\"p-button-secondary\" (click)=\"cerrarSession()\" ></p-button>\n        </div>\n    </div>\n    <ng-container *ngFor=\"let item of model; let i = index;\">\n        <li app-menuitem *ngIf=\"!item.separator\" [item]=\"item\" [index]=\"i\" [root]=\"true\"></li>\n        <li *ngIf=\"item.separator\" class=\"menu-separator\"></li>\n    </ng-container>\n    <li *ngIf=\"false\" >\n        <a href=\"https://www.primefaces.org/primeblocks-ng/#/\">\n            <img src=\"assets/layout/images/{{layoutService.config.colorScheme === 'light' ? 'banner-primeblocks' : 'banner-primeblocks-dark'}}.png\" alt=\"Prime Blocks\" class=\"w-full mt-3\"/>\n        </a>\n    </li>\n</ul>\n","import {OnInit} from '@angular/core';\nimport {Component} from '@angular/core';\nimport {LayoutService} from './service/app.layout.service';\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {AuthService} from \"../service/auth/auth.service\";\nimport {MenuService} from \"../../app/layout/app.menu.service\";\nimport {UserDetails} from \"../models/user-details.model\";\n\ninterface User {\n    idUsuario: number;\n    userName: string;\n    mail: string;\n    personaByPersonaIdPersona2: {\n        identificacion: string;\n        apellido: string;\n        idPersona: number;\n        nombres: string;\n        fechaNacimiento: string;\n    };\n    rolUsuariosByIdUsuario: any[];\n}\n\n@Component({\n    selector: 'app-menu',\n    templateUrl: './app.menu.component.html'\n})\nexport class AppMenuComponent implements OnInit {\n\n    model: any[] = [];\n    usersList: UserDetails[] = [];\n    userDetails: User | null = null;\n\n    constructor(public layoutService: LayoutService,\n                private accountService: AuthService,\n                private router: Router,\n                private route: ActivatedRoute,\n                private authService: AuthService,\n                private menuservice: MenuService) {\n    }\n\n    ngOnInit() {\n        this.loadUserDetails();\n        if (this.userDetails) {\n            this.model = this.getMenuItems();  // Suponiendo que getMenuItems es un método que devuelve los items del menú\n            this.loadUsersList();  // Suponiendo que este método depende de userDetails\n        } else {\n            this.router.navigate(['/login']);  // Redirige al login si no hay detalles de usuario\n        }\n    }\n    private getMenuItems(): any[] {\n        // Retorna los items del menú basados en el rol o permisos del usuario\n        return [\n            { label: 'Usuario', icon: 'pi pi-fw pi-pencil', routerLink: ['/medico/receta-create'] },\n            { label: 'Mostrar Recetas', icon: 'pi pi-fw pi-list', routerLink: ['/medico/receta-listado'] }\n        ];\n    }\n    loadUserDetails() {\n        const userDetailsJson = localStorage.getItem('userDetails');\n        if (userDetailsJson) {\n            this.userDetails = JSON.parse(userDetailsJson);\n        } else {\n            console.log('No userDetails found in localStorage');\n        }\n    }\n\n    loadUsersList(): void {\n        const idUsuario = this.getCurrentidUsuario();\n        this.menuservice.getUsuariosList(idUsuario).subscribe(\n            (users: UserDetails[]) => {\n                this.usersList = users;\n            },\n            error => {\n                console.error('Error loading users list', error);\n                // Manejar el error aquí si es necesario\n            }\n        );\n    }\n    private getCurrentidUsuario(): number {\n        const userIdString = localStorage.getItem('idUsuario');\n        if (userIdString === null) {\n            console.error('No user ID found in localStorage');\n            this.router.navigate(['/login']);\n            return 0;\n        }\n        return parseInt(userIdString, 10);\n    }\n    cerrarSession(): void {\n        const idUsuario = this.getCurrentidUsuario();\n        this.authService.logout(idUsuario).subscribe(\n            response => {\n                console.log('Logout successful, navigating to login');\n                this.router.navigateByUrl('/login').then(success => {\n                    console.log('Navigation to login successful:', success);\n                }).catch(error => {\n                    console.error('Navigation to login failed:', error);\n                });\n            },\n            error => {\n                console.error('Error during logout', error);\n            }\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}