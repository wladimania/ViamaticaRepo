{"ast":null,"code":"import * as XLSX from 'xlsx';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/usermainten/usermaintenance.service\";\nimport * as i2 from \"../../service/auth/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../welcome/welcome.component\";\nfunction UsermaintenanceComponent_app_welcome_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-welcome\");\n  }\n}\nfunction UsermaintenanceComponent_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function UsermaintenanceComponent_button_9_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.openFileUploader());\n    });\n    i0.ɵɵtext(1, \"Carga Masiva\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UsermaintenanceComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h2\");\n    i0.ɵɵtext(2, \"Bienvenido\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction UsermaintenanceComponent_div_13_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 17);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 17);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 17);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 17);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\")(12, \"ul\")(13, \"li\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"li\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"li\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"li\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"li\");\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const user_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7.idUsuario);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7.userName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7.mail);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7.status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7.intentoFallido);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"ID Persona: \", user_r7.personaByPersonaIdPersona2.idPersona, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Nombre: \", user_r7.personaByPersonaIdPersona2.nombres, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Apellido: \", user_r7.personaByPersonaIdPersona2.apellido, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Identificaci\\u00F3n: \", user_r7.personaByPersonaIdPersona2.identificacion, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fecha de Nacimiento: \", user_r7.personaByPersonaIdPersona2.fechaNacimiento, \"\");\n  }\n}\nfunction UsermaintenanceComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"table\")(2, \"caption\", 15);\n    i0.ɵɵtext(3, \"Lista de Usuarios\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"thead\")(5, \"tr\")(6, \"th\");\n    i0.ɵɵtext(7, \"ID Usuario\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Nombre de Usuario\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Correo Electr\\u00F3nico\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Intentos Fallidos\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Detalles de la Persona\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"tbody\");\n    i0.ɵɵtemplate(19, UsermaintenanceComponent_div_13_tr_19_Template, 23, 10, \"tr\", 16);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(19);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.usersList);\n  }\n}\nexport class UsermaintenanceComponent {\n  constructor(usermaintenanceService, authService, router) {\n    this.usermaintenanceService = usermaintenanceService;\n    this.authService = authService;\n    this.router = router;\n    this.userDetails = null;\n    this.usersList = [];\n  }\n  ngOnInit() {\n    this.loadUserDetails();\n    this.loadUsersList();\n  }\n  loadUserDetails() {\n    const userDetailsJson = localStorage.getItem('userDetails');\n    if (userDetailsJson) {\n      this.userDetails = JSON.parse(userDetailsJson);\n    }\n  }\n  loadUsersList() {\n    const idUsuario = this.getCurrentidUsuario();\n    this.usermaintenanceService.getUsuariosList(idUsuario).subscribe(users => {\n      this.usersList = users;\n    }, error => {\n      console.error('Error loading users list', error);\n      // Manejar el error aquí si es necesario\n    });\n  }\n\n  logout() {\n    const idUsuario = this.getCurrentidUsuario();\n    this.authService.logout(idUsuario).subscribe(response => {\n      console.log('Logout successful, navigating to login');\n      this.router.navigateByUrl('/login').then(success => {\n        console.log('Navigation to login successful:', success);\n      }).catch(error => {\n        console.error('Navigation to login failed:', error);\n      });\n    }, error => {\n      console.error('Error during logout', error);\n    });\n  }\n  getCurrentidUsuario() {\n    const userIdString = localStorage.getItem('idUsuario');\n    if (userIdString === null) {\n      console.error('No user ID found in localStorage');\n      this.router.navigate(['/login']);\n      return 0;\n    }\n    return parseInt(userIdString, 10);\n  }\n  // Función para abrir el selector de archivo\n  openFileUploader() {\n    const fileUploader = document.getElementById('fileUploader');\n    if (fileUploader) {\n      fileUploader.click();\n    }\n  }\n  handleFileInput(event) {\n    const file = event.target.files[0];\n    const reader = new FileReader();\n    reader.onload = e => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const sheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[sheetName];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet, {\n        header: 1\n      });\n      jsonData.forEach(row => {\n        if (row.length === 0) {\n          console.log(\"Fila vacía, saltando...\");\n          return; // Saltar la iteración si la fila está vacía\n        }\n\n        console.log(\"Fila actual:\", row);\n        const usuario = {\n          userName: row[0],\n          mail: row[1],\n          password: row[2],\n          status: row[3],\n          intentoFallido: row[4],\n          personaByPersonaIdPersona2: {\n            identificacion: row[5],\n            apellido: row[6],\n            nombres: row[7],\n            idPersona: 0,\n            fechaNacimiento: row[8] // Ajustar el índice para la fecha de nacimiento si es necesario\n          }\n        };\n\n        this.createUser(usuario);\n      });\n    };\n    reader.readAsArrayBuffer(file);\n  }\n  createUser(usuario) {\n    this.usermaintenanceService.createUser(usuario).subscribe(response => {\n      console.log('Usuario creado exitosamente:', response);\n      // Agrega esta línea para imprimir el usuario creado en la consola\n      console.log(usuario);\n    }, error => {\n      console.error('Error al crear el usuario:', error);\n    });\n  }\n}\nUsermaintenanceComponent.ɵfac = function UsermaintenanceComponent_Factory(t) {\n  return new (t || UsermaintenanceComponent)(i0.ɵɵdirectiveInject(i1.UsermaintenanceService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router));\n};\nUsermaintenanceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UsermaintenanceComponent,\n  selectors: [[\"app-usermaintenance\"]],\n  decls: 14,\n  vars: 4,\n  consts: [[1, \"dashboard-layout\"], [1, \"sidebar\"], [4, \"ngIf\"], [1, \"dashboard-content\"], [1, \"dashboard-topbar\"], [1, \"dashboard-topbar-title\"], [1, \"logout-button\", 3, \"click\"], [\"class\", \"massive-upload-button\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"file\", \"id\", \"fileUploader\", \"accept\", \".csv,.xlsx\", 2, \"display\", \"none\", 3, \"change\"], [1, \"dashboard-main-content\"], [\"class\", \"welcome-message\", 4, \"ngIf\"], [\"class\", \"table-container\", 4, \"ngIf\"], [1, \"massive-upload-button\", 3, \"click\"], [1, \"welcome-message\"], [1, \"table-container\"], [2, \"font-size\", \"1.2em\", \"font-weight\", \"bold\"], [4, \"ngFor\", \"ngForOf\"], [1, \"center\"]],\n  template: function UsermaintenanceComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"nav\", 1);\n      i0.ɵɵtemplate(2, UsermaintenanceComponent_app_welcome_2_Template, 1, 0, \"app-welcome\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 3)(4, \"header\", 4)(5, \"h1\", 5);\n      i0.ɵɵtext(6, \"Dashboard\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function UsermaintenanceComponent_Template_button_click_7_listener() {\n        return ctx.logout();\n      });\n      i0.ɵɵtext(8, \"Cerrar Sesi\\u00F3n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(9, UsermaintenanceComponent_button_9_Template, 2, 0, \"button\", 7);\n      i0.ɵɵelementStart(10, \"input\", 8);\n      i0.ɵɵlistener(\"change\", function UsermaintenanceComponent_Template_input_change_10_listener($event) {\n        return ctx.handleFileInput($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"div\", 9);\n      i0.ɵɵtemplate(12, UsermaintenanceComponent_div_12_Template, 3, 0, \"div\", 10);\n      i0.ɵɵtemplate(13, UsermaintenanceComponent_div_13_Template, 20, 1, \"div\", 11);\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.userDetails);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.usersList && ctx.usersList.length > 0);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", !ctx.usersList || ctx.usersList.length === 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.usersList && ctx.usersList.length > 0);\n    }\n  },\n  dependencies: [i4.NgIf, i4.NgForOf, i5.WelcomeComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["XLSX","i0","UsermaintenanceComponent","constructor","usermaintenanceService","authService","router","ngOnInit","loadUserDetails","loadUsersList","userDetailsJson","localStorage","getItem","userDetails","JSON","parse","idUsuario","getCurrentidUsuario","getUsuariosList","subscribe","users","usersList","error","console","logout","response","log","navigateByUrl","then","success","catch","userIdString","navigate","parseInt","openFileUploader","fileUploader","document","getElementById","click","handleFileInput","event","file","target","files","reader","FileReader","onload","e","data","Uint8Array","result","workbook","read","type","sheetName","SheetNames","worksheet","Sheets","jsonData","utils","sheet_to_json","header","forEach","row","length","usuario","userName","mail","password","status","intentoFallido","personaByPersonaIdPersona2","identificacion","apellido","nombres","idPersona","fechaNacimiento","createUser","readAsArrayBuffer","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\desta\\Downloads\\FrontEnd\\src\\app\\views\\usermaintenance\\usermaintenance.component.ts","C:\\Users\\desta\\Downloads\\FrontEnd\\src\\app\\views\\usermaintenance\\usermaintenance.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {UserDetails} from \"../../models/user-details.model\";\nimport {AuthService} from \"../../service/auth/auth.service\";\nimport {Router} from \"@angular/router\";\nimport {UsermaintenanceService} from \"../../service/usermainten/usermaintenance.service\";\nimport * as XLSX from 'xlsx';\n@Component({\n  selector: 'app-usermaintenance',\n  templateUrl: './usermaintenance.component.html',\n  styleUrls: ['./usermaintenance.component.scss']\n})\nexport class UsermaintenanceComponent implements OnInit {\n    userDetails: UserDetails | null = null;\n    usersList: UserDetails[] = [];\n\n    constructor(\n        private usermaintenanceService  : UsermaintenanceService,\n        private authService: AuthService,\n        private router: Router\n    ) { }\n\n    ngOnInit(): void {\n        this.loadUserDetails();\n        this.loadUsersList();\n    }\n\n    loadUserDetails() {\n        const userDetailsJson = localStorage.getItem('userDetails');\n        if (userDetailsJson) {\n            this.userDetails = JSON.parse(userDetailsJson);\n        }\n    }\n\n    loadUsersList(): void {\n        const idUsuario = this.getCurrentidUsuario();\n        this.usermaintenanceService.getUsuariosList(idUsuario).subscribe(\n            (users: UserDetails[]) => {\n                this.usersList = users;\n            },\n            error => {\n                console.error('Error loading users list', error);\n                // Manejar el error aquí si es necesario\n            }\n        );\n    }\n\n    logout(): void {\n        const idUsuario = this.getCurrentidUsuario();\n        this.authService.logout(idUsuario).subscribe(\n            response => {\n                console.log('Logout successful, navigating to login');\n                this.router.navigateByUrl('/login').then(success => {\n                    console.log('Navigation to login successful:', success);\n                }).catch(error => {\n                    console.error('Navigation to login failed:', error);\n                });\n            },\n            error => {\n                console.error('Error during logout', error);\n            }\n        );\n    }\n\n    private getCurrentidUsuario(): number {\n        const userIdString = localStorage.getItem('idUsuario');\n        if (userIdString === null) {\n            console.error('No user ID found in localStorage');\n            this.router.navigate(['/login']);\n            return 0;\n        }\n        return parseInt(userIdString, 10);\n    }\n    // Función para abrir el selector de archivo\n    openFileUploader(): void {\n        const fileUploader = document.getElementById('fileUploader');\n        if (fileUploader) {\n            fileUploader.click();\n        }\n    }\n\n    handleFileInput(event: any): void {\n        const file = event.target.files[0];\n        const reader = new FileReader();\n\n        reader.onload = (e: any) => {\n            const data = new Uint8Array(e.target.result);\n            const workbook = XLSX.read(data, { type: 'array' });\n            const sheetName = workbook.SheetNames[0];\n            const worksheet = workbook.Sheets[sheetName];\n            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\n            jsonData.forEach((row: any) => {\n                if (row.length === 0) {\n                    console.log(\"Fila vacía, saltando...\");\n                    return; // Saltar la iteración si la fila está vacía\n                }\n\n                console.log(\"Fila actual:\", row);\n                const usuario: UserDetails = {\n                    userName: row[0],\n                    mail: row[1],\n                    password: row[2],\n                    status: row[3],\n                    intentoFallido: row[4],\n                    personaByPersonaIdPersona2: {\n                        identificacion: row[5],\n                        apellido: row[6],\n                        nombres: row[7],\n                        idPersona: 0, // Valor predeterminado para idPersona\n                        fechaNacimiento: row[8] // Ajustar el índice para la fecha de nacimiento si es necesario\n                    }\n                };\n\n                this.createUser(usuario);\n            });\n\n\n\n        };\n\n        reader.readAsArrayBuffer(file);\n    }\n\n\n\n    createUser(usuario: UserDetails): void {\n        this.usermaintenanceService.createUser(usuario).subscribe(\n            response => {\n                console.log('Usuario creado exitosamente:', response);\n                // Agrega esta línea para imprimir el usuario creado en la consola\n                console.log(usuario);\n            },\n            error => {\n                console.error('Error al crear el usuario:', error);\n            }\n        );\n    }\n\n\n\n}\n","<div class=\"dashboard-layout\">\n    <nav class=\"sidebar\">\n        <app-welcome *ngIf=\"userDetails\"></app-welcome>\n    </nav>\n    <div class=\"dashboard-content\">\n        <header class=\"dashboard-topbar\">\n            <h1 class=\"dashboard-topbar-title\">Dashboard</h1>\n            <button (click)=\"logout()\" class=\"logout-button\">Cerrar Sesión</button>\n            <button *ngIf=\"usersList && usersList.length > 0\" class=\"massive-upload-button\" (click)=\"openFileUploader()\">Carga Masiva</button>\n            <input type=\"file\" id=\"fileUploader\" accept=\".csv,.xlsx\" style=\"display: none\" (change)=\"handleFileInput($event)\">\n        </header>\n        <div class=\"dashboard-main-content\">\n            <div *ngIf=\"!usersList || usersList.length === 0\" class=\"welcome-message\">\n                <h2>Bienvenido</h2>\n            </div>\n            <div *ngIf=\"usersList && usersList.length > 0\" class=\"table-container\">\n                <table>\n                    <caption style=\"font-size: 1.2em; font-weight: bold;\">Lista de Usuarios</caption> <!-- Título de la tabla -->\n                    <thead>\n                    <tr>\n                        <th>ID Usuario</th>\n                        <th>Nombre de Usuario</th>\n                        <th>Correo Electrónico</th>\n                        <th>Status</th>\n                        <th>Intentos Fallidos</th>\n                        <th>Detalles de la Persona</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    <tr *ngFor=\"let user of usersList\">\n                        <td class=\"center\">{{ user.idUsuario }}</td>\n                        <td class=\"center\">{{ user.userName }}</td>\n                        <td class=\"center\">{{ user.mail }}</td>\n                        <td class=\"center\">{{ user.status }}</td>\n                        <td class=\"center\">{{ user.intentoFallido }}</td>\n                        <td>\n                            <ul>\n                                <li>ID Persona: {{ user.personaByPersonaIdPersona2.idPersona }}</li>\n                                <li>Nombre: {{ user.personaByPersonaIdPersona2.nombres }}</li>\n                                <li>Apellido: {{ user.personaByPersonaIdPersona2.apellido }}</li>\n                                <li>Identificación: {{ user.personaByPersonaIdPersona2.identificacion }}</li>\n                                <li>Fecha de Nacimiento: {{ user.personaByPersonaIdPersona2.fechaNacimiento }}</li>\n                            </ul>\n                        </td>\n                    </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}